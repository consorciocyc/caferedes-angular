<div class="container-fluid container-modified">
  <div class="col-12">
    <h3 class="mb-3 title">Permisos</h3>
  </div>
  <div class="col-12 mb-2">
    <button class="btn btn_primary mr-3 btn-sm d-inline-block" data-toggle="modal" data-target="#crear_usuario" (click)="new_user()">Nuevo</button>
    <button class="btn btn_primary mr-3 btn-sm d-inline-block" (click)="search_init()">Buscar</button>
  </div>
  <div class="row mt-12">
    <div class="col-12">
      <table class="table table-striped table-bordered table-hover text-center font-table" id="users">
        <thead>
          <tr>

            <th class="theader__short">Id </th>
            <th class="theader__extralong">Nombres </th>
            <th class="theader__extralong">Apellidos</th>
            <th class="">Cedula</th>
            <th class="theader__extralong">Mail</th>
            <th class="">Password</th>
            <th class="">Perfil</th>
            <th class="">Estado</th>
            <th class="">Contrato</th>
            <th class="">Almacen</th>
            <th class="">Editar</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let newrow of list_user; let i=index">

            <td class="tdody_content">
              {{newrow.idusuarios}}
            </td>
            <td class="tdody_content">
              {{newrow.usuario_name}}
            </td>
            <td class="tdody_content">
              {{newrow.usuario_last_name}}
            </td>
            <td class="tdody_content">
              {{newrow.usuario_cedula}}
            </td>
            <td class="tdody_content">
              {{newrow.usuario_mail}}
            </td>
            <td class="tdody_content">
              {{newrow.usuario_pass}}
            </td>
            <td class="tdody_content">
              {{newrow.name}}
            </td>
            <td class="tdody_content">
              {{newrow.state}}
            </td>


            <td>
              <button class="btn btn-sm btn_select btn_table" value="{{newrow.idprofile_company}}" (click)="contratos($event)"
                data-toggle="modal" data-target="#contratos">Contratos</button>
            </td>
            <td>
              <button class="btn btn-sm btn_select btn_table" value="{{newrow.idprofile_company}}" (click)="search_cellar($event)"
                data-toggle="modal" data-target="#almacenes">Almacenes</button>
            </td>
            <td>
              <button class="btn btn-sm btn_select btn_table" value="{{newrow.idusuarios}}" data-toggle="modal"
                data-target="#crear_usuario" (click)="search_user($event)">Actualizar</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


<!-- modal para editar y crear contratos -->
<div class="modal fade" id="crear_usuario" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Crear Usuario</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #form_user="ngForm" class="px-4">
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">ID Usuario</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="idusuarios" #idusuarios="ngModel"
                [(ngModel)]="usermodel.idusuarios" readonly />
            </div>
          </div>
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Nombre</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="usuario_name" #usuario_name="ngModel"
                [(ngModel)]="usermodel.usuario_name" required />
              <span *ngIf="usuario_name.errors?.required && usuario_name.touched" class="error_message">el campo es
                requerido</span>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Apellidos</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="usuario_last_name" #usuario_last_name="ngModel"
                [(ngModel)]="usermodel.usuario_last_name" required />
              <span *ngIf="usuario_last_name.errors?.required && usuario_last_name.touched" class="error_message">el
                campo es requerido</span>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Cedula</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="usuario_cedula" #usuario_cedula="ngModel"
                [(ngModel)]="usermodel.usuario_cedula" required />
              <span *ngIf="usuario_cedula.errors?.required && usuario_cedula.touched" class="error_message">el campo es
                requerido</span>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Mail</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="usuario_mail" #usuario_mail="ngModel"
                [(ngModel)]="usermodel.usuario_mail" required />
              <span *ngIf="usuario_mail.errors?.required && usuario_mail.touched" class="error_message">el campo es
                requerido</span>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Password</label>
            <div class="col-9">
              <input class="form-control input-modified" type="text" name="usuario_pass" #usuario_pass="ngModel"
                [(ngModel)]="usermodel.usuario_pass" required />
              <span *ngIf="usuario_pass.errors?.required && usuario_pass.touched" class="error_message">el campo es
                requerido</span>
            </div>
          </div>

          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Estado</label>
            <div class="col-9">
              <select class="form-control input-modified" name="id_state" #id_state="ngModel" [(ngModel)]="usermodel.id_state"
                required required>
                <option *ngFor="let list_states of list_states" value="{{list_states.idstate}}">{{list_states.state}}</option>
              </select>
              <span *ngIf="id_state.errors?.required && id_state.touched" class="error_message">el campo es requerido</span>
            </div>
          </div>

          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Perfil</label>
            <div class="col-9">
              <select class="form-control input-modified" name="usuario_idprofile" #usuario_idprofile="ngModel"
                [(ngModel)]="usermodel.usuario_idprofile" required required>
                <option *ngFor="let list_profile of list_profile" value="{{list_profile.idP_profiles}}">{{list_profile.name}}</option>
              </select>
              <span *ngIf="usuario_idprofile.errors?.required && usuario_idprofile.touched" class="error_message">el
                campo es requerido</span>
            </div>
          </div>
        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn_danger btn-sm" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn_success btn-sm" [disabled]="!form_user.valid || btninsert" (click)="create_profile()"
          data-dismiss="modal"> Guardar</button>
        <button type="button" class="btn btn_success btn-sm" [disabled]="btnupdate" (click)="update_user()">Modificar</button>
      </div>
    </div>
  </div>
</div>


<!-- modal para editar y crear contratos -->
<div class="modal fade" id="contratos" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="exampleModalLabel">Contratos</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #form_add="ngForm" class="px-4">


          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Contrato</label>
            <div class="col-9">
              <select class="form-control input-modified" name="idcontrac" #id_contrac="ngModel" [(ngModel)]="idcontrac"
                required required>
                <option *ngFor="let list_contrac of list_contrac" value="{{list_contrac.idcontract}}">{{list_contrac.contract_name}}</option>
              </select>
              <span *ngIf="id_state.errors?.required && id_state.touched" class="error_message">el campo es requerido</span>
            </div>
          </div>

          <table class="table table-striped table-bordered table-hover text-center" id="users">
            <thead>
              <tr>

                <th>Item </th>
                <th> Contrato</th>
                <th>Eliminar </th>


              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let newrow of list_contra; let i=index">

                <td>
                  {{i+1}}
                </td>
                <td>
                  {{newrow.contract_name}}
                </td>



                <td>
                  <button class="btn btn_danger btn-sm" value="{{newrow.idpermisos_contract}}" (click)="delete($event)">Eliminar</button>
                </td>

              </tr>
            </tbody>
          </table>

        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn_danger btn-sm" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn_success btn-sm" [disabled]="!form_add.valid || btninsert" (click)="add_contract()">
          Guardar</button>

      </div>
    </div>
  </div>
</div>


<!-- modal para gestion de almacenes -->
<div class="modal fade" id="almacenes" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="exampleModalLabel">Almacenes</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #form_add="ngForm" class="px-4">


          <div class="form-group row">
            <label class="col-3 col-form-label label-required">Almacenes</label>
            <div class="col-9">
              <select class="form-control input-modified" name="idalmacenes" #id_contrac="ngModel" [(ngModel)]="idalmacenes"
                required required>
                <option *ngFor="let list_contrac of list_contrac" value="{{list_contrac.idcontract}}">{{list_contrac.contract_name}}</option>
              </select>
              <span *ngIf="id_state.errors?.required && id_state.touched" class="error_message">el campo es requerido</span>
            </div>
          </div>

          <table class="table table-striped table-bordered table-hover text-center" id="users">
            <thead>
              <tr>

                <th>Item </th>
                <th> Contrato</th>
                <th>Eliminar </th>


              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let newrow of list_contra; let i=index">

                <td>
                  {{i+1}}
                </td>
                <td>
                  {{newrow.contract_name}}
                </td>



                <td>
                  <button class="btn btn_danger btn-sm" value="{{newrow.idpermisos_contract}}" (click)="delete_cellar($event)">Eliminar</button>
                </td>

              </tr>
            </tbody>
          </table>

        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn_danger btn-sm" data-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn_success btn-sm" [disabled]="!form_add.valid || btninsert" (click)="save_cellar()">
          Guardar</button>

      </div>
    </div>
  </div>
</div>